
☆ gm.his

あんまり詳しくないです。

ソースファイルをみてね。きたないけど・・・

確認できるローダー

PIC ：pic.r, apic.r, picl.x, apicg.r, epicl.r, hapic.r, picw.x
Pi  ：picl.x, pi.r, apicg.r, pil.x
MAG ：mag.r, magl.r, apicg.r, hmagl.r
MAKI：gmaki.r, mag.r, apicg.r
JPEG：jpgl.x jpeg.x jpeged.r

これ以外は持ってないか使ってないのでわからない。


「gm.x バージョンアップ履歴」---------------------------------------------------

version 0.86 -> 0.87

常駐部分の無駄なコードを削除.

TGUSEMDの内部コールテーブルがなぜか足りなかったのでなおした.


version 0.85 -> 0.86

新バージョンのミントで６４Ｋチェックが失敗するのをなおした.


version 0.84 -> 0.85

１６色表示前に６４Ｋ &gvram-on するとパレットチェックで間違えるのを修正。

６４Ｋ２倍ズームでマスクされてしまうバグをなおした.


version 0.83 -> 0.84

２５６色でグラフィック最大色の設定ができなかったのを修正。

グラフィック復帰対応(謎)


version 0.82 -> 0.83

マスク禁止状態でグラフィックがオフになってしまうバグをなおした。


version 0.81 -> 0.82

_G_CLR_ONのバグを修正した。

-s を６４Ｋの時に実行するとバスエラーで死ぬのでなにもせず終了するようにした。

２５６色パレットを計算で求めるようにした。


version 0.80 -> 0.81

FLAME.X に完全対応したはず。

mint.x で動作不良になっていたのを修正した。

パレットセーバーを _EXIT, _EXIT2 でフックするようにした。


version 0.79 -> 0.80

Muterm でテキストパレットが初期化されないバグをなおした。

-s[n] でＧＲＡＭ、パレットの強制保存をできるようにした。


version 0.78 -> 0.79

６４Ｋで FLAME.X を使用しているときなどパレット初期化しないようにした。

G.X version 3.00 以降との相性を若干改善した。

Muterm で６４Ｋの画面をトーンダウンのまま使えるようにした。


version 0.77 -> 0.78

グラフィッククリッピングエリアの設定で意味不明なことやっていたからなおした。

-a[n] によりＧＭの動作を停止できるようにした。ただし、_TGUSEMDによるＧＭ制御はで

きる。（この方が戻すのが楽かなとか思って(^^;）

ＳＴＦでコマンド引数に -q を付けていた場合エラーが出ることがあったのをなおした。


version 0.76 -> 0.77

無駄なような気がしたけど、６４Ｋでもグラフィックオフ状態を保存するようにした。

グラフィッククリッピングエリアの設定を常に (0,0)-(511,767) にしていたのを６４Ｋ

では (0,0)-(511,511)にするようにした。


version 0.75 -> 0.76

画面モードが７６８×５１２、６４Ｋの時に半透明や特殊プライオリティを保存するよう

にした。

オートマスク禁止状態で、６４Ｋグラフィックオフ状態の動作が抜けていたのをなおした。

１６色グラフィックオフ状態が不完全で、pst.xがエラーを出すのをなおした。

１６色でかつグラフィックを消去しない場合はグラフィックスクロールレジスタをクリア

するようにした。


version 0.74.1 -> 0.75

_G_CLR_ON でグラフィックオンにしていなかったのを直した。

_CRTMODで１６色の場合に無条件でグラフィックオンになっていたのをなおした。

μEmacsの終了時にマスクのパレットが変わるのをなおした。


version 0.74 -> 0.74.1

スクエアマスクに対応する為にぷち追加(^^;

_TGUSEMDでスクロールレジスタの初期化はしないように戻した。いままでやらなかった理

由を忘れてた・・・


version 0.73 -> 0.74

pil.x, hmagl.r での不都合を直した。＜動作条件を絞りすぎたらしい。

_TGUSEMDが呼ばれた時にスクロールレジスタを初期化するようにした。


version 0.72 -> 0.73

オートパレットセーバーの動作条件を絞って、動作をさらに軽くした。ついでに apicg.r

などの２４ＫＨｚのロードに対応した。２４ＫＨｚで誤動作するローダーがあるなら教え

て下さい。このため、グラフィックが１６色の時にはだいたいパレット保存ができるよう

になってます。

_TGUSEMDのルーチンをいじった。＜サイズを少しでも小さくするため


version 0.71 -> 0.72

特定条件の時にオートパレットセーバーがまともに働かなくて輝度復帰できなかったバグ

をなおした。気づいた人いますか？


version 0.70 -> 0.71

テキストの表示状態をＯＮにしていなかったので、mmvpの終了後に画面が見えなくなって

いたのをなおした。

グラフィック画面の色数などを設定するのを忘れていたのをなおした。（設定しないとグ

ラフィックなしと見なされる。apicg で不都合発覚(^^;）なんだかまだありそうな・・・


version 0.69 -> 0.70

いつのまにか _TGUSEMD のマスク一時禁止が使用不可能になっていたのをなおした。

_TPALET のルーチンを修正した。＜あはは(^^;

フラグチェックに btst.b を使っていたのをやめた。

_TXXLINE, _TXYLINE のマスク外しは正確にするようにした。新たに _TXBOX でもマスク

を外すようにした。

μEmacsの画面フラッシュでマスク部分も光るようにした。

常駐チェックルーチンの一部がまずかったのをなおした。

拡張用に取っておいたとこで用済みなところは削除した。（gmに追加すべき機能でなかっ

たため）これで一応完成した。


version 0.68 -> 0.69

常駐サイズ削減のためルーチンの移動を行った。それと、ワークをテキストセクションに

とるようにした。このためファイルサイズが若干大きくなっていますが、常駐サイズは２

分の１ぐらいになったはずです。

ついでに常駐するところは少し手を入れた。

１６色のＧＮＣモードでも IOCS _CRTMOD を呼ばないようにした。


version 0.67 -> 0.68

常駐パレット（謎）のルーチンを組み込んだ。

オートパレットセーバー（妖しい）を搭載した。

それにともなって trap15 のベクタを乗っ取るようになった。（gnc2l 互換モード？）

りいざさんに $GVON 付近のソースをもらったので、ぷにゅぷにゅやった（謎）

$MIOFで、ぷぅ～なのをなおした。（意味不明）

オートマスク禁止状態での $GVON Gキー、一周でパレットやモードが変になるエンバグを

なおした。

グラフィック書き換えチェックを少し強化した。（書き換えチェックは常にやるわけでは

ないので重くなったりしません。）

画面モードが不明な時の動作を変更した。

常駐時に -d を使用できるようになった。（結構いい加減・・・）


version 0.66 -> 0.67

７６８×５１２、６４Ｋの時には IOCS _CRTMOD を呼ばずに内臓ルーチンでモード切り替

えをするようにした。IOCS はグラフィック・スクロール・レジスタをクリアするため。

手抜きにより高速なんだけど、不都合でたらごめん。

パレットが初期化されないバグをなおした。

hapic で不都合出ているのをなおした。うぅ、発見が遅れたぁ・・・すいません。

マウスカーソルが出ている時に常駐解除したりするとゴミるのをなおした。

マスクがあるべき時にないと強制的にマスクするようになった。

マスクセット、クリアのルーチンでスーパーバイザー、ユーザーモードの切り替えが必要

でないのでしないようにした。


version 0.65 -> 0.66

モード切り替え時にパレット関係で画面が見苦しかった点をなおした。

１６色のグラフィックで$GCLRが効かなくなるバグをなおした。


version 0.64 -> 0.65

パレットアクセスで画面がぷちぷちうるさいので、Ｖ－ＤＩＳＰ信号見るようにした。

まだチェックの時ぷちぷちなっているけど・・・・

７６８×５１２のモード変更でパレットが６４Ｋの時は特別扱いをするようにした。

オートマスク禁止ができなくなるエンバグをなおした。

mfged を立ちあげると右ボタンでソフトキーボードが出るという間抜けな不都合をなおし

た。


version 0.63 -> 0.64

１６色画像を$GVONで一周するとマスクがかかるというのは仕様。だといやなので、１６

色用のルーチン追加。ただし２５６色の$GVON一周はぜんぜん見てないので、たぶん不都

合でる・・・

ついでに _G_CLR_ON も１６色に対応した。

ＧＮＣオプションが付いてない時の動作はテスト回数が少ないためエンバグしている可能

性があります。（だってぜんぜん使わないんだもん・・・）

グラフィック消去して再び表示する時にマスクがかかるというバグをなおした。

６４Ｋパレットが変になる時があったから初期化するようにした。それにともなって

_TPALET2 でパレット初期化をしないようにした。


version 0.62.1 -> 0.63

エラー表示は -v に影響されないようにした。（なんとなく）

スイッチの読み取りに数値（１０進数）が付いた。

グラフィック画面が消えないというバグ的な仕様をなおした。

解析に ＳＴＦ ver. 2.00 を用いました。

これ以後のバージョンはＳＴＦ ver. 2.00 以降で動作確認しています。2.00以前のもの

では誤動作するかもしれません。


version 0.62 -> 0.62.1

マスクカラーを変更。gmss.x を使って中央に画像表示すると多少気になるため。


version 0.61.2 -> 0.62

エンバグ、エンバグ、なおして、ポン。

_TXXLINEの座標チェックが甘かったのをなおした。

-k スイッチで電卓消去時にマスクをなおすようにした。（マスクがある時、必要な所に

マスクをする。）


version 0.61.1 -> 0.61.2

余分なコードを削除した。


version 0.61 -> 0.61.1

ＴＭＮΣのコンフィグが間違ったので起動していたのでちょっと変更した。

.tf に $GCLR;apicg と書いてないとまずいのをなおした。（apicgのみでもマスクが外れ

るようにした。）


version 0.60 -> 0.61

６４Ｋパレットのセットルーチンのループ数が少なかったのをなおした。

ＴＭＮΣで PIC 画像見れるように _TPALET2の時にグラフィックパレットを初期化するよ

うにした。（BASICLIBがIOCSを通らないための処置）


version 0.59 -> 0.60

はぁ～っ、うげ、ぴぃ、スペル間違えてた。

符号のこと忘れてたところをなおした。

今まで MAG.R と思っていたのは実は「MAGL.R」 だった。。。

ＣＲＴＣにセットするレジスタのサイズを間違えていたのをなおした。

これでＧＣＣでＧＲＡＭ使ってもハングしなくなるはず。

パレット初期化は先頭の１６個見るようにした。

μEmacsのクロスカーソルに対応した。

apicg に対応した？

確認できるローダー

PIC ：pic.r, apic.r, picl.x, apicg.r, epicl.r, hapic.r
Pi  ：picl.x, pi.r, apicg.r
MAG ：mag.r, magl.r
MAKI：gmaki.r, mag.r

これ以外は持ってないからわからない。


version 0.58 -> 0.59

TGUSEMDの拡張をやった。（拡張コード用の「gm_internal.mac」を作った。）

凶悪なレジスタ保存をなくして、必要なものだけ保存するようにした。

内部コールができたのでルーチンに手を加えた。


version 0.57 -> 0.58

うひょ、'-?' が消えてなかった。

一部のメッセージ表示方法を少し変えた。

常駐する時 stackセクションを解放するようにした。


version 0.56 -> 0.57

NEW_TGUSEMDがバグってたのをなおした。（きぃ、くやしぃ）

やっぱりＴＭＮΣで不都合が出た。

バッファにＧＲＡＭを取っていると暴走するのをなおした。


version 0.55 -> 0.56

グラフィックパレットが初期化される時があるようなので６４Ｋ用のパレットで

初期化するようにした。ただし先頭の８個だけしか見ない。

オプションスイッチ '-?' をなくした。

ＴＭＮΣでの不都合なおした。


version 0.54 -> 0.55

TGUSEMDの拡張の準備（できたかなぁ

MAG.Rで１６色を表示した時マスクが外れないバグをなおした。

ときどき画面がカラフル斜めぴかぴかになっているときがあったけどなおしてない。。。

シェルから画像ロードした時ＧＮＣモードが変だけどなおしてない。。。


version 0.53 -> 0.54

NEW_TPALET_set_0 がきちんと動作しないバグを撃墜した。

（ＸＣＶ２のライブラリマニュアルＶＯＬ．２に間違いがあった。具体的に言うと、

　IOCS _TPALET2は d2.l に－２は設定できない。ＲＯＭのルーチンがそうなっていた。

　このためカラーコード $fffe(白色) と間違えて設定されてしまう。）

ＧＮＣぷにモードの時マスクフラグの設定を忘れていたのでなおした。これでパレット

が変にならなくなったはず。


version 0.52 -> 0.53

$GV_2 の [ESC] が効かないのをなおそうとしたけど。６４Ｋモードができなかった(^^;

SuperED でマスクが付かないのは仕様と割り切る。


version 0.50 -> 0.52

ＧＮＣ６４Ｋモードでマスクを禁止すると画面が変になったのをなおした。

１６色の画像をＳＴＦの $GV_2 を使って見ようとすると画面が切れり、マスクが付くの

をなおした。


version 0.40 -> 0.50

NEW_TGUSEMD と NEW_G_CLR_ON を（ちょこっと）修正。

GNC64K(Graphic Not Clear for 64K colors)モードを新たに搭載。（不完全かも）


version 0.30 -> 0.40

最初からパレット設定を間違えてたのをなおした。（バカすぎ）

lhv が _TGUSEMD を見ないから常にマスクを外すようにした。

_TGUSEMDを内部から使用できるようにした。

オートマスクの許可スイッチをつけた。これでオートで一発なはず・・・

IOCSを乗っ取る時に面倒だからベクタの設定などをマクロ化した。


version 0.25 -> 0.30

_G_CLR_ONを乗っ取る。

ＭＡＧファイルの不都合はとれたはず・・・


version 0.20 -> 0.25

ヘルプメッセージのスイッチを小文字にした(^^;

-h でヘルプメッセージの表示をするようにした。

パレット関係がへぼだったからなおした。

マスクをなるべく自動に・・・

_TGUSEMDを乗っ取ってテキストラムの使用時にマスクを外すようにした。


version 0.10 -> 0.20

常駐してＳＴＦのパレットイルミネーションにも対応。

初めて常駐解除できるのをつくった。


version 0.10

とりあえずできた。常駐無しばーじょん。

ＳＴＦのパレットイルミネーションできたなくなる・・・ぷひ


