
☆ gm.doc

「機能など．．．」--------------------------------------------------------------

	★MINT のグラフィック閲覧環境を素晴らしくするプログラム。当たり前のこと
	  をするだけなので過剰な期待はしないように。

	★MINT から６４Ｋ色の画像をロードしたあとに、７６８×５１２の画面の両端
	  をテキストプレーン３を使ってマスクします。

	★画面モードによりオートでマスクが付いたり外れたりします。マスクを禁止す
	  ることもできます。

	★MINT のパレットイルミネーションに対応してます。（常駐した時）

	★６４Ｋ色モード用のＧＮＣ（Graphic Not Clear）モード搭載。何処に行って
	  もグラフィックがついてきます（笑）

	★さらに１６色モード用のＧＮＣも搭載。（gnc2l と同等のもの）

	★常駐パレット（謎）機能＆オートパレットセーバー（妖しい）がついてます。
	  （１６色専用）常駐パレットでいつでも輝度１００％にできる。

	★不完全ながら外部からＧＭの制御ができる。

	★トーンダウンは gmss.x 以外のものでも大丈夫。(FLAME.Xに対応しました。)


「オプションスイッチ」----------------------------------------------------------

Graphic Mask version 0.87 programmed by JACK
使用法: gm <スイッチ>
スイッチ:
	-m	マスク設定
	-c	マスク解除
	-d	オートマスク不許可
	-e	オートマスク許可
	-f	テキストラムを強制使用する
	-n	ＧＮＣモードを有効にする
	-k	電卓消去時にマスクをなおす
	-p	メモリ常駐
	-r	常駐解除
	-a[n]	ＧＭ主要動作の制御 (0:停止 [1]:動作)
	-s[n]	状態保存 (0:パレット 1:GVRAM [2]:両方)
	-v	バージョン表示、メッセージ表示
	-h	ヘルプメッセージ

スイッチは大文字／小文字を区別しません。


	-m	常駐していない時：その場ですぐにマスクする。
		常駐している時  ：次に「IOCS _CRTMOD」が呼ばれて７６８×５１２の
				  画面になった時にマスクする。"gm -c" が実行され
				  るとマスクは消える。ただし７６８×５１２以外の
				  画面モードでは一時的に消す。それと -m 実行時に
				  すでに７６８×５１２のモードで６４Ｋ色表示なら
				  その場でマスクする。

	-c	常駐していない時：マスクを外して終わり。
		常駐している時  ：マスクを外して、-m スイッチを無効にする。

	-d	常駐する時(-p)に一緒につけるとオートマスクを許可しない状態で常駐
		してくれます。マスクがつくと寂しい人はつけてください。
		常駐している時は、これ以後のオートマスクを許可しません。普通は実
		行する必要はないです（たぶん）。

	-e	常駐している時に有効で、これ以後のオートマスクを許可します。（デ
		フォルト状態）-d で不許可にした時にもとに戻すために使用する。

	-f	テキストラムが使用されている時に強制的に未使用状態にする。
		-p と一緒に使うと、強制的にマスクをするようになる。使用の際は十
		分気をつけること。単独指定は意味がありません。

	-n	常駐する時(-p)に一緒につけるとＧＮＣモードを有効にします。デフォ
		ルトは無効です。単独指定は意味がありません。これで gnc2l もどき
		の機能も働くようになってます。この時に gnc2l を併用するのは避け
		て下さい。たぶん後から常駐させた方のみが動作します。（一緒に使っ
		た時の動作保証はしません）

	-k	常駐する時(-p)に一緒につけると電卓を消去した時にマスクにできる穴
		をなおすようにします。単独指定は意味がありません。

	-p	メモリに常駐する。-vfnkd 以外は無視される。-d が指定されないと、
		６４Ｋ色のモードの場合にマスクします。それ以外ではマスククリアさ
		れます。-d を一緒につけるとオートマスクを許可しないようになりま
		す。好みでつけてね。

	-r	ベクタを復帰して、メモリを解放する。-vf 以外は無視される。
		マスクは消去される。

	-a[n]	ＧＭの動作を制御します。パラメータが０の場合は _TGUSEMD による制
		御以外の動作を一時停止します。ただし、IOCSベクタなどは復帰しませ
		ん。パラメータが１の場合はＧＭの動作を開始します。このスイッチは
		ＧＭと相性が悪かったり、ＧＭ内部バグの為に解除しなきゃいけない場
		合等に使用するものであり積極的に使うべきものではありません。

	-s[n]	現在の状態をＧＭ内部に保存します。パラメータが０の場合は１６色パ
		レット、１の場合はＧＶＲＡＭ、２の場合は両方保存します。なお、数
		値が省略された場合は２と見なします。また、６４Ｋ色のモードで実行
		した場合はなにもせず終了します。このスイッチは、対応できない
		(IOCSを使用していない)グラフィックローダ等で使ってください。

	-v	通常はメッセージを表示しないが、このスイッチでメッセージが表示さ
		れるようになる。単独指定ではバージョン（タイトル）表示のみ。

	-h	ヘルプメッセージを表示する。強制的に -v 状態になる。同時に指定し
		たスイッチは無効になります。

	複数同時に指定可能です。（-vfp など）別に１個づつでもいいです。
	スイッチは -h が一番優先度が高い。次に -p と -r がつづく。
	-f は -m などと一緒に使用する。-n, -k は -p のみと一緒に使用できる。


＝＝ 注 意 ＝＝

  このプログラムは２５６色のモードに対応してません。また、７６８×５１２の画面サ
イズで使うことを想定してます。（ＳＴＦ、MINT 以外のファイラーには対応してない。
一応必要以上にチェックしているから大丈夫と信じる。また、MINT及びMINTを引き継ぐ新
しいもの以外のファイラーに対応するつもりは今のところないです。）

  電卓マスクのルーチンはＸＶＩのやつを元に作ったのでこれ以外では動作しないかも。

  テキストパレットの初期値はＳＲＡＭから得るのできちんと設定しておくこと。特にパ
レット０はＲＧＢ全部０でないとグラフィックは見れません。＜あたりまえだ

  常駐している時は、６５５３６色表示可能なモードにすると、 次に７６８×５１２の
モードに戻った時にマスクされる。 嫌な時は、常駐するときに "gm -pnd" 等とするか、
予め "gm -d" を実行して、オートマスクを許可しないようにしてください。戻す時は、
"gm -e" を実行してください。

  ６４Ｋ色のＧＮＣモードは常にグラフィックパレット初期化＆トーンダウン＆センタリ
ング状態で実行されます。

  gnc2l.x の併用は絶対に避けてください。（gm.x を -n 付きで常駐させれば gnc2l.x
の代わりに使えます。）

  常駐パレット、オートパレットセーバーはＳＴＦ version 2.34以降で威力を発揮しま
す。対応してくれたりいざさんに感謝します。もちろん MINT でも使用可能です。

  オートパレットセーバーはグラフィックＶＲＡＭが書き換わった時に１６色のパレット
を保存します。その書き換えチェックは画面上の９ヶ所（ドット）をチェックしています
ので、余りにも小さいグラフィックを表示したり、グラフィックが同じでパレットが違う
というような場合はパレットの保存ができない場合があります。このチェックは常にやる
わけではなく、IOCSコールの _CRTMOD _TGUSEMD _G_CLR_ON を実行した後に特定のコール
で表示が１６色な時にのみ１回だけチェックします。これらのIOCSコールはグラフィック
ローダーならどれか１つは通るはずです。通らないと残念ながらパレットの保存はできま
せん。

  スイッチ指定時に "/" は使用できません。


「使用方法など．．．」----------------------------------------------------------

  MINT の起動前に gnc2l の代わりに

	gm -pnk

と、やるだけ。


  MINT を起動して、好きなＰＩＣなり、ＪＰＥＧなりロードしてみてください。両端が
黒色でマスクされましたか？  次にＧキーでグラフィック閲覧モードに入ってみましょ
う。マスクが外れましたか？  閲覧モードから戻ってきたらマスクが再び現れましたか？

  これが＜オートマスク＞です。

  そうしたら、次にグラフィックを表示してから、テキストエディタ（ED.Xなど）を起動
してみましょう。グラフィックが見えてますか？  終了してみましょう。グラフィックが
見えてる？  見えてなかったら、たぶんバグです(^^;

  こっちが＜ＧＮＣモード＞です。

  オートマスクが嫌な時は "gm -d" を実行してみましょう。 これ以後のオートマスクは
実行されません。（"-c"を一緒につけると今ついているマスクも外します。）ＧＮＣモー
ドだけ有効になります。（常駐する時に "gm -pnd" とすると始めからオートマスクを許
可しません。）

  ＧＮＣモードがいらない時は始めに "gm -p" だけで常駐させてください。ＧＮＣモー
ドは後から追加できません。必要な時は、いったん常駐解除してから "gm -pn" で常駐し
なおしてください。

  常駐解除は "gm -r" を実行すればできます。 テキストラムが使用中で解除できない時
は、強制使用の "-f" をつけて、"gm -fr" で解除できるようになります。

  あるプログラム（ここでは foo.x とする）を立ちあげる時に、 どうしてもマスクが邪
魔をするとき、

	foo.x %p/%

を実行したければ、

	gm -dc||foo.x %p/%||gm -em

というのを実行すれば大丈夫です。普通のプログラムなら、まず必要ありません。


「まだ残っている問題点」--------------------------------------------------------

  SuperEDを起動時に一瞬マスクが消える。これはパレット０の内容をコピーして見かけ
上消すという変なことをやっているためです。SuperEDを使っている人は別配布の差分を
ダウンしてください。

  ＧＭを常駐させると、まれに起動してくれないプログラムがあるようです。その場合は
'gmss -g0' とやってグラフィックを一時的に消せば起動できるようになるものもありま
す。

  終了時にグラフィック画面の消去を画面切り替えで済ますようなプログラムでは残って
しまいます。（その為のプログラムだ）汚くなったら 'gmss -rc' でクリアしましょう。


「使用した物など」--------------------------------------------------------------

ほんたい    ：X68000 XVI(24MHz)

おぉえす    ：Human68k version 3.01

しぇる      ：fish.x 0.8.1

ふぁいらぁ  ：MINT Ver 1.78

えでぃた    ：SuperED v1.18 test7(改造品)
              μEmacs 3.10-J1.43 Rel5

ふぇっぷ    ：RJJ Ver 0.21.1

あせんぶらぁ：has v3.09

りんかぁ    ：hlk v3.01

たぁみなる  ：ＴＭＮΣ v1.4.6

ろぐりぃだぁ：ＣＮ v0.81+よっきゅん

その他      ：libc 1.1.30b


「転載などについて」------------------------------------------------------------

  このプログラムはフリーウェアです。著作権は放棄しません。

  改変、転載、再配布等自由に行ってかまいません。ただし、元の配布ファイルはすべて
一緒に付けて、改変箇所があれば明確に表記して下さい。また、バージョンアップ等はで
きるだけサポートして下さい。SuperEDのパッチも一緒に転載してくれると助かります。

  このプログラムを実行して起こる損害について、作者及び改変者は責任を負う義務はあ
りません。個人の責任の元で使用して下さい。

  不都合などを発見しましたら、教えてくれるとうれしいです。その際に使用したＳＴＦ
のバージョン及びグラフィックローダー名（picl.x 等）も教えてくれるとデバッグがは
かどります。


「感謝」------------------------------------------------------------------------

FLAME.X作者の季羅氏から６４Ｋのトーンダウンについて教えてもらいました。また、
gmss.xのバグも指摘してくれました。

秀蘭氏から gm v0.7x のバグ報告や要望を多数いただきました。また、μEmacs上での不
都合を報告してくれたり、動作確認をしてもらいました。秀蘭氏の協力によりデバッグが
楽になって、より安定させることができました。

Ｋａｚｚ氏は$GCLR関係のバグを見つけてくれました。

りいざ氏にＳＴＦへの常駐パレット、スクエアモードのマスク等の対応をやってもらいま
した。常駐パレットは、りいざ氏の書き込みを見て作りました。

蟹氏からＴＭＮΣでのバグ報告をもらいました。

psycho.氏から２５６色での不都合報告もらいました。

その他のバグ・不都合を報告してくれた人、ありがとうございます。

また、TF/STF/MINTという素晴しいプラットホームを作られた方々に深く感謝します。


「うぴぴ」----------------------------------------------------------------------

変更点は gm.his を参照してください。

今回のバージョンはほとんど手を入れてません ^^;

そういえば HAPICの方でマスク対応してもらったようで... ありがとうございます.


	聖まりあんぬＢＢＳ	MRIA0059
	どこかの謎のＢＢＳ	NAZO0270
	ＡＬＴＡ ＮＥＴ		ALTA1355

					  JACK

